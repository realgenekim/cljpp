PUSH-( ns examples.program17 POP

PUSH-( defn lazy-range
  PUSH-[ start end POP
  PUSH-( letfn PUSH-[ PUSH-( PUSH-[ x POP
                             PUSH-( when PUSH-( < x end POP
                               PUSH-( lazy-seq
                                 PUSH-( cons x PUSH-( lazy-range-helper PUSH-( inc x POP POP POP POP POP POP POP POP
    PUSH-( lazy-range-helper start POP POP POP

PUSH-( defn lazy-fibonacci
  PUSH-( PUSH-[ POP PUSH-( lazy-fibonacci 0 1 POP POP
  PUSH-( PUSH-[ a b POP
    PUSH-( lazy-seq
      PUSH-( cons a PUSH-( lazy-fibonacci b PUSH-( + a b POP POP POP POP POP POP

PUSH-( defn take-while-sum
  PUSH-[ max-sum coll POP
  PUSH-( letfn PUSH-[ PUSH-( helper PUSH-[ remaining-sum s POP
                           PUSH-( when PUSH-( and PUSH-( seq s POP PUSH-( > remaining-sum 0 POP POP
                             PUSH-( let PUSH-[ x PUSH-( first s POP POP
                               PUSH-( when PUSH-( <= x remaining-sum POP
                                 PUSH-( lazy-seq
                                   PUSH-( cons x PUSH-( helper PUSH-( - remaining-sum x POP PUSH-( rest s POP POP POP POP POP POP POP POP POP
    PUSH-( helper max-sum coll POP POP POP

PUSH-( defn -main
  PUSH-[ & args POP
  PUSH-( println "Lazy range 1-10:" PUSH-( vec PUSH-( lazy-range 1 11 POP POP POP
  PUSH-( println "First 10 Fibonacci:" PUSH-( vec PUSH-( take 10 PUSH-( lazy-fibonacci POP POP POP POP
  PUSH-( println "Take while sum <= 20 from [5 3 8 2 7]:" PUSH-( vec PUSH-( take-while-sum 20 PUSH-[ 5 3 8 2 7 POP POP POP POP POP

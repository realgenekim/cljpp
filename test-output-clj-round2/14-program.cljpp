PUSH-( ns examples.program14 POP

PUSH-( defprotocol Drawable
  PUSH-( draw PUSH-[ this POP POP
  PUSH-( bounds PUSH-[ this POP POP
POP

PUSH-( defrecord Circle PUSH-[ x y radius POP
  Drawable
  PUSH-( draw PUSH-[ this POP
    PUSH-( println PUSH-( str "Drawing circle at " PUSH-( :x this POP "," PUSH-( :y this POP " with radius " PUSH-( :radius this POP POP POP
  POP
  PUSH-( bounds PUSH-[ this POP
    PUSH-{ :x-min PUSH-( - PUSH-( :x this POP PUSH-( :radius this POP POP
           :x-max PUSH-( + PUSH-( :x this POP PUSH-( :radius this POP POP
           :y-min PUSH-( - PUSH-( :y this POP PUSH-( :radius this POP POP
           :y-max PUSH-( + PUSH-( :y this POP PUSH-( :radius this POP POP POP
  POP
POP

PUSH-( defrecord Rectangle PUSH-[ x y width height POP
  Drawable
  PUSH-( draw PUSH-[ this POP
    PUSH-( println PUSH-( str "Drawing rectangle at " PUSH-( :x this POP "," PUSH-( :y this POP " with dimensions " PUSH-( :width this POP "x" PUSH-( :height this POP POP POP
  POP
  PUSH-( bounds PUSH-[ this POP
    PUSH-{ :x-min PUSH-( :x this POP
           :x-max PUSH-( + PUSH-( :x this POP PUSH-( :width this POP POP
           :y-min PUSH-( :y this POP
           :y-max PUSH-( + PUSH-( :y this POP PUSH-( :height this POP POP POP
  POP
POP

PUSH-( defn -main PUSH-[ & args POP
  PUSH-( let PUSH-[ c PUSH-( ->Circle 10 20 5 POP
              r PUSH-( ->Rectangle 0 0 100 50 POP POP
    PUSH-( draw c POP
    PUSH-( println "Circle bounds:" PUSH-( bounds c POP POP
    PUSH-( draw r POP
    PUSH-( println "Rectangle bounds:" PUSH-( bounds r POP POP
  POP
POP

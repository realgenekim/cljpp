(ns examples.program18)
(defn wrap-logging [handler] (fn [request] (println "Request:" (:uri request)) (let [response (handler request)] (println "Response:" (:status response)) response)))
(defn wrap-auth [handler] (fn [request] (if (:authenticated? request) (handler request) {:status 401, :body "Unauthorized"})))
(defn app-handler [request] (case (:uri request) "/" {:status 200, :body "Home"} "/users" {:status 200, :body "Users"} "/admin" {:status 200, :body "Admin"} {:status 404, :body "Not Found"}))
(def app (-> app-handler wrap-auth wrap-logging))
PUSH-( ns examples.program23 POP

PUSH-( defn tree-map PUSH-[ f tree POP
  PUSH-( when tree
    PUSH-( -> tree
      PUSH-( assoc :value PUSH-( f PUSH-( :value tree POP POP POP
      PUSH-( update :left PUSH-( partial tree-map f POP POP
      PUSH-( update :right PUSH-( partial tree-map f POP POP-ALL

PUSH-( defn tree-reduce PUSH-[ f acc tree POP
  PUSH-( if tree
    PUSH-( let PUSH-[
      acc1 PUSH-( f acc PUSH-( :value tree POP POP
      acc2 PUSH-( tree-reduce f acc1 PUSH-( :left tree POP POP
      acc3 PUSH-( tree-reduce f acc2 PUSH-( :right tree POP POP
    POP
      acc3
    POP
    acc
  POP-ALL

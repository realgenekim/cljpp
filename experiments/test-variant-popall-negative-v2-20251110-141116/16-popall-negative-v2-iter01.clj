(ns examples.program16)
(defn parse-char [expected] (fn [input] (if (and (seq input) (= expected (first input))) [[(first input) (rest input)]] nil)))
(defn return [value] (fn [input] [[value input]]))
(defn bind [parser f] (fn [input] (when-let [result (parser input)] (let [[value rest-input] result] ((f value) rest-input)))))
(defn choice [parser1 parser2] (fn [input] (or (parser1 input) (parser2 input))))
(defn many [parser] (fn [input] (loop [acc [] remaining input] (if-let [result (parser remaining)] (let [[value rest-input] result] (recur (conj acc value) rest-input)) [[acc remaining]]))))
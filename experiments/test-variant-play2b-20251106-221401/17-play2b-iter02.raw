PUSH-( ns examples.program17 POP

PUSH-( defn lazy-range PUSH-[ start end POP
  PUSH-( letfn PUSH-[ PUSH-( step PUSH-[ n POP
    PUSH-( when PUSH-( < n end POP
      PUSH-( lazy-seq PUSH-( cons n PUSH-( step PUSH-( inc n POP POP POP POP
    POP POP POP
    PUSH-( step start POP
  POP
POP

PUSH-( defn lazy-fibonacci
  PUSH-( PUSH-[ POP PUSH-( lazy-fibonacci 0 1 POP POP
  PUSH-( PUSH-[ a b POP
    PUSH-( lazy-seq PUSH-( cons a PUSH-( lazy-fibonacci b PUSH-( + a b POP POP POP POP
  POP
POP

PUSH-( defn take-while-sum PUSH-[ pred coll POP
  PUSH-( letfn PUSH-[ PUSH-( helper PUSH-[ xs acc POP
    PUSH-( if PUSH-( empty? xs POP
      acc
      PUSH-( let PUSH-[ x PUSH-( first xs POP
              new-sum PUSH-( + acc x POP POP
        PUSH-( if PUSH-( pred new-sum POP
          PUSH-( lazy-seq PUSH-( cons x PUSH-( helper PUSH-( rest xs POP new-sum POP POP POP
          nil
        POP
      POP
    POP
  POP POP
    PUSH-( helper coll 0 POP
  POP
POP-ALL

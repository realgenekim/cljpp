PUSH-( ns examples.program14 POP

PUSH-( defprotocol Drawable
  PUSH-( draw PUSH-[ this POP "Render the shape" POP
  PUSH-( bounds PUSH-[ this POP "Return bounding box as {:x :y :width :height}" POP-ALL

PUSH-( defrecord Circle PUSH-[ x y radius POP
  Drawable
  PUSH-( draw PUSH-[ this POP
    PUSH-( str "Circle at (" PUSH-( :x this POP ", " PUSH-( :y this POP ") radius " PUSH-( :radius this POP POP-ALL
  PUSH-( bounds PUSH-[ this POP
    PUSH-{ :x PUSH-( - PUSH-( :x this POP PUSH-( :radius this POP POP
           :y PUSH-( - PUSH-( :y this POP PUSH-( :radius this POP POP
           :width PUSH-( * 2 PUSH-( :radius this POP POP
           :height PUSH-( * 2 PUSH-( :radius this POP POP-ALL

PUSH-( defrecord Rectangle PUSH-[ x y width height POP
  Drawable
  PUSH-( draw PUSH-[ this POP
    PUSH-( str "Rectangle at (" PUSH-( :x this POP ", " PUSH-( :y this POP ") " 
               PUSH-( :width this POP "x" PUSH-( :height this POP POP-ALL
  PUSH-( bounds PUSH-[ this POP
    PUSH-{ :x PUSH-( :x this POP
           :y PUSH-( :y this POP
           :width PUSH-( :width this POP
           :height PUSH-( :height this POP POP-ALL

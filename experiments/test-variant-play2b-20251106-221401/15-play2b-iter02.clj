(ns examples.program15)
(defn dfs [graph start] (loop [stack [start] visited {} result []] (if (empty? stack) result (let [node (peek stack) new-stack (pop stack)] (if (contains? visited node) (recur new-stack visited result) (let [new-visited (conj visited node) new-result (conj result node) neighbors (get graph node []) unvisited (remove (fn [n] (contains? new-visited n)) neighbors) next-stack (into new-stack unvisited)] (recur next-stack new-visited new-result)))))))
(defn bfs [graph start] (loop [queue [start] visited {} result []] (if (empty? queue) result (let [node (first queue) new-queue (into [] (rest queue))] (if (contains? visited node) (recur new-queue visited result) (let [new-visited (conj visited node) new-result (conj result node) neighbors (get graph node []) unvisited (remove (fn [n] (contains? new-visited n)) neighbors) next-queue (into new-queue unvisited)] (recur next-queue new-visited new-result)))))))
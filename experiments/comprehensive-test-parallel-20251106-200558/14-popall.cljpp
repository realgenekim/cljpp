PUSH-( ns examples.program14 POP

PUSH-( defprotocol Drawable
  PUSH-( draw PUSH-[ this POP "Draw the shape" POP
  PUSH-( bounds PUSH-[ this POP "Get bounding box" POP-ALL

PUSH-( defrecord Circle PUSH-[ x y radius POP
  Drawable
  PUSH-( draw PUSH-[ this POP
    PUSH-( str "Circle at (" x ", " y ") with radius " radius POP-ALL
  PUSH-( bounds PUSH-[ this POP
    PUSH-{ :x PUSH-( - x radius POP
           :y PUSH-( - y radius POP
           :width PUSH-( * 2 radius POP
           :height PUSH-( * 2 radius POP-ALL

PUSH-( defrecord Rectangle PUSH-[ x y width height POP
  Drawable
  PUSH-( draw PUSH-[ this POP
    PUSH-( str "Rectangle at (" x ", " y ") with width " width " and height " height POP-ALL
  PUSH-( bounds PUSH-[ this POP
    PUSH-{ :x x :y y :width width :height height POP-ALL

PUSH-( defn -main PUSH-[ & args POP
  PUSH-( let PUSH-[ circle PUSH-( ->Circle 10 20 5 POP
                rect PUSH-( ->Rectangle 0 0 100 50 POP POP
    PUSH-( println PUSH-( draw circle POP POP
    PUSH-( println PUSH-( bounds circle POP POP
    PUSH-( println PUSH-( draw rect POP POP
    PUSH-( println PUSH-( bounds rect POP-ALL

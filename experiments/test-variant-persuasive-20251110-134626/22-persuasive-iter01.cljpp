PUSH-( ns examples.program22 POP

PUSH-( def fibonacci-memo
  PUSH-( memoize
    PUSH-( fn PUSH-[ n POP
      PUSH-( cond
        PUSH-( = n 0 POP 0
        PUSH-( = n 1 POP 1
        :else PUSH-( + PUSH-( fibonacci-memo PUSH-( - n 1 POP POP
                      PUSH-( fibonacci-memo PUSH-( - n 2 POP POP POP
      POP
    POP
  POP
POP

PUSH-( defn custom-memo PUSH-[ f POP
  PUSH-( let PUSH-[ cache PUSH-( atom PUSH-{ POP POP POP
    PUSH-( fn PUSH-[ & args POP
      PUSH-( if-let PUSH-[ result PUSH-( get @cache args POP POP
        result
        PUSH-( let PUSH-[ result PUSH-( apply f args POP POP
          PUSH-( swap! cache assoc args result POP
          result
        POP
      POP
    POP
  POP
POP
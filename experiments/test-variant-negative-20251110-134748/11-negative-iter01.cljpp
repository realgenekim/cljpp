(ns examples.program11
  (:require [clojure.core.async :as async :refer [go go-loop <! >! chan close!]]))

(defn pipeline [input-ch]
  (let [step1-ch (chan)
        step2-ch (chan)]
    (go-loop []
      (when-some [val (<! input-ch)]
        (>! step1-ch (* 2 val))
        (recur))
      (close! step1-ch))
    (go-loop []
      (when-some [val (<! step1-ch)]
        (>! step2-ch (+ 10 val))
        (recur))
      (close! step2-ch))
    step2-ch))
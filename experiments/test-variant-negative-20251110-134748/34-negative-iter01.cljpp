PUSH-( ns examples.program34
  PUSH-( :require
    PUSH-[ compojure.core :refer PUSH-[ defroutes GET POST POP POP
    PUSH-[ compojure.coerce :refer PUSH-[ as-int POP POP
    PUSH-[ ring.util.response :refer PUSH-[ response POP POP
  POP
POP

PUSH-( defn get-users PUSH-[ request POP
  PUSH-( response PUSH-{ :users PUSH-[ PUSH-{ :id 1 :name "Alice" POP PUSH-{ :id 2 :name "Bob" POP POP POP POP
POP

PUSH-( defn get-user PUSH-[ PUSH-{ :keys PUSH-[ id POP POP POP
  PUSH-( response PUSH-{ :id PUSH-( as-int id POP :name "Alice" :email "alice@example.com" POP POP
POP

PUSH-( defn get-user-posts PUSH-[ PUSH-{ :keys PUSH-[ id POP POP POP
  PUSH-( response PUSH-{ :user-id PUSH-( as-int id POP :posts PUSH-[ PUSH-{ :id 1 :title "First Post" POP PUSH-{ :id 2 :title "Second Post" POP POP POP POP
POP

PUSH-( defn create-user PUSH-[ PUSH-{ :keys PUSH-[ params POP POP POP
  PUSH-( response PUSH-{ :status "created" :user params POP POP
POP

PUSH-( defroutes app-routes
  PUSH-( GET "/users" request PUSH-( get-users request POP POP
  PUSH-( GET "/users/:id" PUSH-{ :keys PUSH-[ params POP POP PUSH-( get-user params POP POP
  PUSH-( GET "/users/:id/posts" PUSH-{ :keys PUSH-[ params POP POP PUSH-( get-user-posts params POP POP
  PUSH-( POST "/users" request PUSH-( create-user request POP POP
POP
POP
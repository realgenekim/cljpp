PUSH-( ns examples.program35
  PUSH-( :require
    PUSH-[ clojure.test.check :as tc POP
    PUSH-[ clojure.test.check.generators :as gen POP
    PUSH-[ clojure.test.check.properties :as prop POP-ALL

PUSH-( def user-gen
  PUSH-( gen/hash-map
    :id PUSH-( gen/large-integer* PUSH-{ :min 1 POP POP
    :name PUSH-( gen/not-empty gen/string-alphanumeric POP
    :email PUSH-( gen/fmap
      PUSH-( fn PUSH-[ s POP PUSH-( str s "@example.com" POP-ALL
      gen/string-alphanumeric POP
    :age PUSH-( gen/large-integer* PUSH-{ :min 18 :max 120 POP POP-ALL

PUSH-( def valid-user-prop
  PUSH-( prop/for-all PUSH-[ user user-gen POP
    PUSH-( and
      PUSH-( pos? PUSH-( :id user POP POP
      PUSH-( string? PUSH-( :name user POP POP
      PUSH-( re-matches #".*@example\.com" PUSH-( :email user POP POP
      PUSH-( >= PUSH-( :age user POP 18 POP-ALL

PUSH-( def age-in-range-prop
  PUSH-( prop/for-all PUSH-[ user user-gen POP
    PUSH-( let PUSH-[ age PUSH-( :age user POP POP
      PUSH-( and PUSH-( >= age 18 POP PUSH-( <= age 120 POP-ALL

PUSH-( defn run-tests PUSH-[ POP
  PUSH-( println "Testing user generator properties..." POP
  PUSH-( let PUSH-[
    result1 PUSH-( tc/quick-check 100 valid-user-prop POP
    result2 PUSH-( tc/quick-check 100 age-in-range-prop POP
  POP
    PUSH-( println "Valid user property:" PUSH-( :result result1 POP POP
    PUSH-( println "Age range property:" PUSH-( :result result2 POP POP-ALL
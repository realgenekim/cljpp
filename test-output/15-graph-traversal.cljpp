PUSH-( ns examples.graphs POP

PUSH-( def graph PUSH-{
  :a PUSH-[ :b :c POP
  :b PUSH-[ :d :e POP
  :c PUSH-[ :f POP
  :d PUSH-[ POP
  :e PUSH-[ :f POP
  :f PUSH-[ POP
POP POP

PUSH-( defn dfs PUSH-[ graph start POP
  PUSH-( loop PUSH-[ visited PUSH-{ POP
              stack PUSH-[ start POP
              result PUSH-[ POP
  POP
    PUSH-( if PUSH-( empty? stack POP
      result
      PUSH-( let PUSH-[ node PUSH-( peek stack POP
                stack' PUSH-( pop stack POP
      POP
        PUSH-( if PUSH-( visited node POP
          PUSH-( recur visited stack' result POP
          PUSH-( let PUSH-[ neighbors PUSH-( get graph node PUSH-[ POP POP
                    visited' PUSH-( assoc visited node true POP
                    stack'' PUSH-( into stack' neighbors POP
                    result' PUSH-( conj result node POP
          POP
            PUSH-( recur visited' stack'' result' POP
          POP
        POP
      POP
    POP
  POP
POP

PUSH-( defn bfs PUSH-[ graph start POP
  PUSH-( loop PUSH-[ visited PUSH-{ start true POP
              queue PUSH-[ start POP
              result PUSH-[ POP
  POP
    PUSH-( if PUSH-( empty? queue POP
      result
      PUSH-( let PUSH-[ node PUSH-( first queue POP
                queue' PUSH-( vec PUSH-( rest queue POP POP
                neighbors PUSH-( get graph node PUSH-[ POP POP
                unvisited PUSH-( filter PUSH-( fn PUSH-[ n POP PUSH-( not PUSH-( visited n POP POP POP neighbors POP
                visited' PUSH-( reduce PUSH-( fn PUSH-[ v n POP PUSH-( assoc v n true POP POP visited unvisited POP
                queue'' PUSH-( into queue' unvisited POP
      POP
        PUSH-( recur visited' queue'' PUSH-( conj result node POP POP
      POP
    POP
  POP
POP

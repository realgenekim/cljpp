PUSH-( ns examples.lazy POP

PUSH-( defn lazy-fib
  PUSH-( PUSH-[ POP PUSH-( lazy-fib 0 1 POP POP
  PUSH-( PUSH-[ a b POP
    PUSH-( lazy-seq
      PUSH-( cons a PUSH-( lazy-fib b PUSH-( + a b POP POP POP
    POP
  POP
POP

PUSH-( defn lazy-primes PUSH-[ POP
  PUSH-( letfn PUSH-[
    PUSH-( sieve PUSH-[ s POP
      PUSH-( lazy-seq
        PUSH-( let PUSH-[ p PUSH-( first s POP POP
          PUSH-( cons p
            PUSH-( sieve
              PUSH-( filter PUSH-( fn PUSH-[ x POP PUSH-( not= 0 PUSH-( mod x p POP POP POP PUSH-( rest s POP POP
            POP
          POP
        POP
      POP
    POP
  POP
    PUSH-( sieve PUSH-( iterate inc 2 POP POP
  POP
POP

PUSH-( defn lazy-tree-walk PUSH-[ tree POP
  PUSH-( letfn PUSH-[
    PUSH-( walk PUSH-[ node POP
      PUSH-( lazy-seq
        PUSH-( when node
          PUSH-( concat
            PUSH-[ PUSH-( :value node POP POP
            PUSH-( walk PUSH-( :left node POP POP
            PUSH-( walk PUSH-( :right node POP POP
          POP
        POP
      POP
    POP
  POP
    PUSH-( walk tree POP
  POP
POP
